import{r as e,j as s,h as r,T as t,G as i,ac as o,D as a,d as n,ad as d,C as l,f as c,R as m,P as h,e as p,B as j,a2 as x,a3 as u}from"./index-BwajA8ZI.js";import{u as f}from"./useAppointmentQueries-B2nz38A-.js";import{u as g}from"./useDoctorQueries-JukiAoYU.js";import{u as w,d as D,a as y,t as T}from"./useWorkingHoursQueries-CO5_5L8l.js";import{I as z,A as b,C}from"./AppointmentDetailsDrawer-BcTSeGgs.js";import{T as v}from"./Table-xGtI38X2.js";import{B as S}from"./Badge-C7klQjz6.js";import{A as k}from"./ActionIcon-DezTz9Pm.js";import{T as I}from"./Title-BFkF6Qaq.js";import{G as A}from"./Grid-wvlf9Z8q.js";import{I as M}from"./IconCalendar-DNm5VTuz.js";import{I as Y}from"./IconPlus-DfgNw28I.js";import"./useQuery-Bb8Fuvgw.js";import"./useMutation-CLdZPAH1.js";import"./appointmentService-Dnp_ZYHK.js";import"./useClinicQueries-YDHrXMm9.js";import"./useUserQueries-DG8wCDbv.js";import"./use-form-BNWfxvNR.js";import"./Select-nRORTan3.js";import"./CheckIcon-B2Dwv-7p.js";import"./Divider-Bfx1wCI6.js";import"./use-isomorphic-layout-effect.browser.esm-eSvD1Z9P.js";import"./IconCheck-Dpo9Liwu.js";import"./IconTrash-CDQov167.js";import"./IconEdit-D_DkOnRz.js";import"./get-base-value-D7dq2aJJ.js";function N({appointments:n=[]}){const[d,l]=e.useState(null),[c,m]=e.useState(!1),{updateAppointmentStatus:h}=f(),p={0:"Scheduled",1:"Cancelled",2:"Completed",3:"No Show"},j={0:"blue",1:"red",2:"green",3:"orange"},x=async(e,s)=>{try{const r=await h.mutateAsync({appointmentId:e,newStatus:s});a.show({title:"Success",message:r.message||"Appointment status updated successfully",color:"green"})}catch(r){a.show({title:"Error",message:r.message||"Failed to update appointment status",color:"red"})}};return 0===n.length?s.jsx(r,{h:200,children:s.jsx(t,{size:"lg",fw:500,c:"dimmed",children:"No appointments scheduled for today"})}):s.jsxs(s.Fragment,{children:[s.jsxs(v,{verticalSpacing:"sm",highlightOnHover:!0,mt:15,children:[s.jsx(v.Thead,{children:s.jsxs(v.Tr,{children:[s.jsx(v.Th,{c:"dimmed",children:"ID"}),s.jsx(v.Th,{c:"dimmed",children:"Patient"}),s.jsx(v.Th,{c:"dimmed",children:"Doctor"}),s.jsx(v.Th,{c:"dimmed",children:"Time"}),s.jsx(v.Th,{c:"dimmed",children:"Status"})]})}),s.jsx(v.Tbody,{children:n.map(e=>{const r=e.status,a=p[r]||"Scheduled",n=j[r]||"blue";return s.jsxs(v.Tr,{style:{cursor:"pointer"},onClick:()=>(e=>{l(e),m(!0)})(e),children:[s.jsx(v.Td,{children:e.id}),s.jsx(v.Td,{children:s.jsx(t,{size:"sm",children:e.patientName})}),s.jsx(v.Td,{children:s.jsxs(t,{size:"sm",children:["Dr. ",e.doctorName]})}),s.jsx(v.Td,{children:s.jsx(t,{size:"sm",children:e.displayTime})}),s.jsx(v.Td,{children:s.jsx(S,{size:"sm",color:n,children:a})}),s.jsx(v.Td,{children:s.jsx(i,{gap:"xs",onClick:e=>e.stopPropagation(),children:s.jsxs(o,{shadow:"md",width:200,children:[s.jsx(o.Target,{children:s.jsx(k,{variant:"subtle",color:"gray",children:s.jsx(z,{size:16})})}),s.jsxs(o.Dropdown,{children:[s.jsx(o.Label,{children:"Update Status"}),s.jsx(o.Item,{onClick:()=>x(e.id,0),color:"blue",children:"Mark as Scheduled"}),s.jsx(o.Item,{onClick:()=>x(e.id,1),color:"red",children:"Mark as Cancelled"}),s.jsx(o.Item,{onClick:()=>x(e.id,2),color:"green",children:"Mark as Completed"}),s.jsx(o.Item,{onClick:()=>x(e.id,3),color:"orange",children:"Mark as No Show"})]})]})})})]},e.id)})})]}),s.jsx(b,{opened:c,onClose:()=>m(!1),appointment:d})]})}const B="_autoHideScrollbar_uhlgo_2";D.extend(y),D.extend(T);const E=e=>D().tz(D.tz.guess()).format("YYYY-MM-DD")===D.utc(e).tz(D.tz.guess()).format("YYYY-MM-DD");function L(){const e=n(),{appointments:o,isLoadingAppointments:a,appointmentsError:y}=f(),{doctors:T,isLoading:z}=g(),{doctorsWorkingDays:b,isLoading:v}=w(),[S,{open:k,close:L}]=d(!1),Q=(o||[]).map(e=>{var s;const r=e.startDate?D.utc(e.startDate).tz(D.tz.guess()):null;return{...e,formattedStartDate:r,doctorName:(null==(s=e.doctor)?void 0:s.name)||"N/A",displayDate:(null==r?void 0:r.format("MMM D, YYYY"))||"Invalid Date",displayTime:(null==r?void 0:r.format("hh:mm A"))||"Invalid Time"}}),G=Q.filter(e=>e.formattedStartDate&&E(e.startDate)),H=Q.filter(e=>e.formattedStartDate&&E(e.startDate)).sort((e,s)=>e.formattedStartDate&&s.formattedStartDate?e.formattedStartDate.isBefore(s.formattedStartDate)?-1:1:0),P=((e,s)=>{const r=D().day();return e.filter(e=>{const t=s[e.id]||[];return 0===t.length||t.includes(r)})})(T,b);return a||z||v?s.jsx(l,{pt:12,fluid:!0,maw:1232,children:s.jsx(r,{h:400,children:s.jsxs(c,{align:"center",children:[s.jsx(m,{size:"lg"}),s.jsx(t,{children:"Loading dashboard..."})]})})}):y?s.jsx(l,{pt:12,fluid:!0,maw:1232,children:s.jsxs(t,{color:"red",children:["Error loading dashboard: ",y.message]})}):s.jsx(l,{pt:12,fluid:!0,maw:1232,h:"200",children:s.jsxs(c,{children:[s.jsx(I,{fz:"24px",order:2,children:"Dashboard"}),s.jsxs(A,{gutter:"md",w:"100%",children:[s.jsx(A.Col,{span:8,children:s.jsxs(c,{children:[s.jsxs(i,{justify:"space-between",gap:"md",w:"100%",children:[s.jsx(h,{withBorder:!0,radius:"md",p:"md",h:100,style:{flex:1},children:s.jsx(i,{justify:"space-between",align:"center",h:"100%",children:s.jsxs(c,{gap:"xs",children:[s.jsxs(i,{gap:"xs",children:[s.jsx(M,{size:20,color:"var(--mantine-color-green-6)"}),s.jsx(I,{order:3,fz:"16px",c:"dimmed",children:"Today's Appointments"})]}),s.jsx(t,{fz:"24px",fw:700,c:"green",children:G.length})]})})}),s.jsx(h,{withBorder:!0,radius:"md",p:"md",h:100,style:{flex:1},children:s.jsx(i,{justify:"space-between",align:"center",h:"100%",children:s.jsxs(c,{gap:"xs",children:[s.jsxs(i,{gap:"xs",children:[s.jsx(M,{size:20,color:"var(--mantine-color-blue-6)"}),s.jsx(I,{order:3,fz:"16px",c:"dimmed",children:"Total Appointments"})]}),s.jsx(t,{fz:"24px",fw:700,c:"blue",children:Q.length})]})})})]}),s.jsxs(h,{withBorder:!0,radius:"md",p:"md",h:500,children:[s.jsxs(i,{justify:"space-between",align:"center",mb:"md",children:[s.jsx(i,{children:s.jsx(I,{order:3,fz:"18px",children:"Upcoming Appointments"})}),s.jsx(p,{onClick:k,leftSection:s.jsx(Y,{size:16}),variant:"outline",size:"md",radius:"xl",fw:500,children:"New Appointment"})]}),s.jsx(j,{style:{overflowY:"auto",height:"calc(100% - 60px)"},className:B,children:s.jsx(N,{appointments:H})})]})]})}),s.jsx(A.Col,{span:4,children:s.jsxs(h,{withBorder:!0,radius:"md",p:"md",h:616,children:[s.jsx(i,{mb:"xs",children:s.jsx(I,{order:4,fz:"lg",children:"Available Doctors"})}),s.jsx(c,{gap:"sm",style:{overflowY:"auto",height:"calc(100% - 40px)"},className:B,children:P.map(r=>s.jsxs(i,{style:{cursor:"pointer",padding:"8px",borderRadius:"8px",transition:"background-color 0.2s ease"},gap:"xs",onClick:()=>{return s=r.id,void e(`/doctors/${s}`);var s},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="var(--mantine-color-gray-1)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[s.jsx(x,{color:"#e7edf6",style:{cursor:"pointer"},size:"md",radius:"xl",variant:"filled",children:s.jsx(t,{fz:"sm",children:u({fullName:r.name})})}),s.jsxs(c,{gap:"0",children:[s.jsxs(t,{fw:500,truncate:!0,children:["Dr. ",r.name]}),s.jsx(t,{size:"sm",c:"dimmed",truncate:!0,children:r.clinicName})]})]},r.id))})]})})]}),s.jsx(C,{opened:S,onClose:L})]})})}export{L as default};
