import{b as Q,aE as X,d as J,Q as K,r as h,j as e,C as g,L as V,G as s,P as f,h as v,T as t,f as x,a3 as w,I as W,D as Y,e as y,ab as k,a4 as Z}from"./index-2K_n1FRf.js";import{u as _}from"./useClinicQueries-BbViY6Ep.js";import{N as u}from"./NotificationService-B6GizKXX.js";import{D as ee}from"./DeleteConfirmationModal-BYhA6zlA.js";import{C as ie}from"./CreateDoctorDrawer-W9kH9G68.js";import{A as c}from"./ActionIcon-pWppweKH.js";import{I as D}from"./IconArrowLeft-CjDmYxPr.js";import{T as j}from"./Title-Clypw5uz.js";import{I as re}from"./IconCheck-BTsRsjRA.js";import{I as se}from"./IconX-Db2JWBuk.js";import{I as ne}from"./IconEdit-B4QlTEb9.js";import{B as te}from"./Badge-CBwcfUsd.js";import{I as ae,a as le}from"./IconTrash-CpIZs9JE.js";import{T as n}from"./Table-DYjjwA0n.js";import{I as oe}from"./IconMail-b99m0eL5.js";import{I as de}from"./IconMapPin-DbWYHll-.js";import"./useQuery-CVFAupRI.js";import"./useMutation-BDHTUPci.js";import"./useDoctorQueries-MuxkZPR3.js";import"./Select-DxHxNxY-.js";import"./CheckIcon-D-4r5XSn.js";/**
 * @license @tabler/icons-react v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ce=Q("outline","user-plus","IconUserPlus",[["path",{d:"M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0",key:"svg-0"}],["path",{d:"M16 19h6",key:"svg-1"}],["path",{d:"M19 16v6",key:"svg-2"}],["path",{d:"M6 21v-2a4 4 0 0 1 4 -4h4",key:"svg-3"}]]);function Me(){const{id:l}=X(),m=J();K();const[a,b]=h.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:l?l.toString():""}),[E,C]=h.useState(!1),[o,N]=h.useState(""),[S,p]=h.useState(!1),[M,z]=h.useState(!1),{clinic:d,doctors:i,isLoading:P,isError:B,error:A,addDoctor:L,updateClinic:O,deleteClinic:q,isAddingDoctor:$,isUpdating:F,isDeleting:I}=_(Number(l)),U=async()=>{if(!a.firstName.trim()){u.error("Error","Doctor first name is required");return}if(!a.lastName.trim()){u.error("Error","Doctor last name is required");return}if(!a.email.trim()){u.error("Error","Doctor email is required");return}if(!a.phoneNumber.trim()){u.error("Error","Doctor phone number is required");return}const r={clinicId:Number(l),firstName:a.firstName.trim(),lastName:a.lastName.trim(),email:a.email.trim(),address:a.address.trim(),phoneNumber:a.phoneNumber.trim()};await L(r),b({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:l?l.toString():""})},R=()=>{N(d.name),C(!0)},T=()=>{N(""),C(!1)},G=async()=>{if(!o.trim()||o===d.name){T();return}try{await O({id:Number(l),name:o.trim()}),C(!1)}catch(r){console.error("Failed to update clinic name:",r)}},H=async()=>{if(i&&i.length>0){u.error("Cannot Delete Clinic",`This clinic has ${i.length} doctor${i.length!==1?"s":""} assigned to it. Please remove all doctors before deleting the clinic.`),p(!1);return}try{await q(Number(l)),m("/clinics")}catch(r){console.error("Failed to delete clinic:",r),p(!1)}};return P?e.jsx(g,{pt:20,maw:1232,fluid:!0,children:e.jsx(V,{visible:!0})}):B?e.jsxs(g,{pt:20,maw:1232,fluid:!0,children:[e.jsxs(s,{mb:"xl",children:[e.jsx(c,{variant:"subtle",onClick:()=>m("/clinics"),size:"lg",children:e.jsx(D,{size:20})}),e.jsx(j,{order:2,children:"Clinic Not Found"})]}),e.jsx(f,{radius:"md",p:"xl",withBorder:!0,children:e.jsx(v,{children:e.jsxs(t,{c:"red",children:["Error: ",A.message]})})})]}):d?e.jsxs(g,{pt:20,maw:1232,fluid:!0,children:[e.jsx(ee,{isOpen:S,onClose:()=>p(!1),onConfirm:H,title:"Delete Clinic",itemName:`"${d.name}"`,isLoading:I,additionalMessage:i&&i.length===0?"This clinic has no doctors assigned to it.":null}),e.jsxs(s,{mb:"xl",children:[e.jsx(c,{hiddenFrom:"sm",variant:"subtle",onClick:()=>m("/clinics"),size:"lg",children:e.jsx(D,{size:20})}),e.jsx(j,{order:2,children:"Clinic Details"})]}),e.jsx(f,{p:"xl",radius:"md",withBorder:!0,maw:800,children:e.jsx(x,{gap:"xl",children:e.jsxs(s,{gap:"xl",align:"flex-start",children:[e.jsx(w,{size:"xl",radius:"50%",variant:"filled",color:"var(--mantine-primary-color-filled)",children:e.jsx(W,{size:40})}),e.jsxs(x,{gap:"xs",style:{flex:1},children:[E?e.jsxs(s,{children:[e.jsx(Y,{value:o,onChange:r=>N(r.target.value),error:o.trim()?null:"Name is required",size:"md",style:{flex:1}}),e.jsx(c,{color:"green",onClick:G,loading:F,disabled:!o.trim()||o===d.name,size:"lg",children:e.jsx(re,{size:20})}),e.jsx(c,{color:"red",onClick:T,size:"lg",children:e.jsx(se,{size:20})})]}):e.jsxs(s,{children:[e.jsx(j,{order:2,fz:28,children:d.name}),e.jsx(c,{variant:"subtle",onClick:R,c:"black",children:e.jsx(ne,{size:20})})]}),e.jsx(s,{gap:"md",children:e.jsx(te,{size:"lg",variant:"filled",color:"blue",children:"CLINIC"})})]}),e.jsxs(x,{align:"flex-end",gap:"xs",children:[i.length>0&&e.jsx(t,{size:"xs",c:"orange",fw:500,ta:"right",children:"Remove all doctors to enable deletion"}),e.jsx(y,{color:"red",radius:"md",variant:"outline",leftSection:e.jsx(ae,{size:16}),onClick:()=>p(!0),loading:I,disabled:i&&i.length>0,title:i&&i.length>0?`Cannot delete clinic with ${i.length} doctor${i.length!==1?"s":""} assigned`:"Delete clinic",children:"Delete Clinic"})]})]})})}),e.jsx(f,{p:"xl",mt:"xl",radius:"md",withBorder:!0,maw:800,children:e.jsxs(x,{gap:"xl",children:[e.jsxs(s,{justify:"space-between",align:"center",children:[e.jsx(j,{order:3,children:"Doctors"}),e.jsxs(s,{gap:"xs",children:[e.jsx(k,{size:20,color:"var(--mantine-color-gray-6)"}),e.jsxs(t,{size:"sm",c:"dimmed",children:[i.length," doctor",i.length!==1?"s":""]}),e.jsx(y,{variant:"filled",radius:"md",leftSection:e.jsx(ce,{size:16}),onClick:()=>z(!0),ml:"md",children:"new Doctor"})]})]}),i.length===0?e.jsx(v,{py:"xl",children:e.jsxs(x,{align:"center",gap:"md",children:[e.jsx(k,{size:48,opacity:.4}),e.jsx(t,{size:"lg",c:"dimmed",children:"No doctors assigned"}),e.jsx(t,{size:"sm",c:"dimmed",children:"This clinic has no doctors assigned to it yet."})]})}):e.jsxs(n,{highlightOnHover:!0,verticalSpacing:"sm",children:[e.jsx(n.Thead,{children:e.jsxs(n.Tr,{children:[e.jsx(n.Th,{c:"dimmed",children:"Name"}),e.jsx(n.Th,{c:"dimmed",children:"Email"}),e.jsx(n.Th,{c:"dimmed",children:"Phone"}),e.jsx(n.Th,{c:"dimmed",children:"Address"})]})}),e.jsx(n.Tbody,{children:i.map(r=>e.jsxs(n.Tr,{style:{cursor:"pointer"},onClick:()=>m(`/doctors/${r.id}`),children:[e.jsx(n.Td,{children:e.jsxs(s,{gap:"sm",children:[e.jsx(w,{size:"sm",radius:"50%",variant:"filled",color:"gray.3",children:e.jsx(t,{size:"xs",children:Z({fullName:r.name})})}),e.jsx(t,{size:"sm",fw:500,children:r.name})]})}),e.jsx(n.Td,{children:e.jsxs(s,{gap:"xs",children:[e.jsx(oe,{size:16,opacity:.6}),e.jsx(t,{size:"sm",children:r.email||"Not provided"})]})}),e.jsx(n.Td,{children:e.jsxs(s,{gap:"xs",children:[e.jsx(le,{size:16,opacity:.6}),e.jsx(t,{size:"sm",children:r.phoneNumber||"Not provided"})]})}),e.jsx(n.Td,{children:e.jsxs(s,{gap:"xs",children:[e.jsx(de,{size:16,opacity:.6}),e.jsx(t,{size:"sm",children:r.address||"Not provided"})]})})]},r.id))})]})]})}),e.jsx(ie,{opened:M,onClose:()=>z(!1),onSubmit:U,doctorData:a,setDoctorData:b,isLoading:$,clinicId:Number(l)})]}):e.jsxs(g,{pt:20,maw:1232,fluid:!0,children:[e.jsxs(s,{mb:"xl",children:[e.jsx(c,{variant:"subtle",onClick:()=>m("/clinics"),size:"lg",children:e.jsx(D,{size:20})}),e.jsx(j,{order:2,children:"Clinic Not Found"})]}),e.jsx(f,{radius:"md",p:"xl",withBorder:!0,children:e.jsx(v,{children:e.jsx(t,{c:"dimmed",children:"The requested clinic could not be found."})})})]})}export{Me as default};
