import{d as C,j as e,f as j,h as T,T as o,G as x,a3 as k,a4 as w,B as b,r as p,ao as v,C as S,an as z,e as f,t as I,P as L}from"./index-2K_n1FRf.js";import{u as B}from"./useDoctorQueries-MuxkZPR3.js";import{u as O,D as A}from"./useWorkingHoursQueries-DaXu6suH.js";import{S as g,I as W}from"./IconUserOff-DyKBPwe3.js";import{T as r}from"./Table-DYjjwA0n.js";import{B as G}from"./Badge-CBwcfUsd.js";import{C as P}from"./CreateDoctorDrawer-W9kH9G68.js";import{u as E}from"./useClinicQueries-BbViY6Ep.js";import{T as H}from"./Title-Clypw5uz.js";import{I as M}from"./IconPlus-6iykoS9v.js";import"./useQuery-CVFAupRI.js";import"./useMutation-BDHTUPci.js";import"./appointmentService-DmIbX8yT.js";import"./NotificationService-B6GizKXX.js";import"./Select-DxHxNxY-.js";import"./CheckIcon-D-4r5XSn.js";function Q({doctorId:d,workingDays:n}){const l=n.length===0?[0,1,2,3,4,5,6]:n;return e.jsx(x,{gap:"8",children:A.map(t=>{const c=l.includes(t.value);return e.jsx(b,{bg:c?"violet":"gray.4",fw:500,p:4,h:24,w:24,style:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},title:t.day,children:e.jsx(o,{size:"xs",fw:500,c:"white",children:t.letter})},t.value)})})}function R({searchQuery:d=""}){const{doctors:n,isLoading:l}=B(),{doctorsWorkingDays:t,isLoading:c}=O(),i=C(),a=s=>{i(`/doctors/${s}`)},m=s=>{i(`/clinics/${s}`)},u=n.filter(s=>{const h=d.toLowerCase();return s.name.toLowerCase().includes(h)||s.clinicName.toLowerCase().includes(h)});return l||c?e.jsxs(j,{children:[e.jsx(g,{height:40,radius:"sm"}),[1,2,3].map(s=>e.jsx(g,{height:50,radius:"sm",mt:"sm"},s))]}):e.jsxs(r,{highlightOnHover:!0,verticalSpacing:"sm",horizontalSpacing:"lg",children:[e.jsx(r.Thead,{children:e.jsxs(r.Tr,{children:[e.jsx(r.Th,{c:"dimmed",children:"Name"}),e.jsx(r.Th,{c:"dimmed",children:"Working Days"}),e.jsx(r.Th,{c:"dimmed",children:"Clinic"})]})}),e.jsx(r.Tbody,{children:u.length===0?e.jsx(r.Tr,{children:e.jsx(r.Td,{colSpan:3,children:e.jsx(T,{py:"xl",children:e.jsxs(j,{align:"center",gap:"md",children:[e.jsx(W,{size:30,opacity:.4}),e.jsx(o,{size:"sm",c:"dimmed",children:"No doctors found"})]})})})}):u.map(s=>e.jsxs(r.Tr,{style:{cursor:"pointer"},onClick:()=>a(s.id),children:[e.jsx(r.Td,{children:e.jsxs(x,{gap:"sm",children:[e.jsx(k,{color:"#e7edf6",style:{cursor:"pointer"},onClick:()=>a(s.id),size:"md",radius:"xl",variant:"filled",children:e.jsx(o,{fz:"sm",children:w({fullName:s.name})})}),e.jsx(o,{size:"sm",fw:600,style:{cursor:"pointer"},onClick:()=>a(s.id),children:s.name})]})}),e.jsx(r.Td,{children:e.jsx(Q,{doctorId:s.id,workingDays:t[s.id]||[]})}),e.jsx(r.Td,{children:e.jsx(G,{variant:"light",size:"lg",radius:"sm",px:"md",style:{cursor:"pointer"},onClick:()=>m(s.clinicId),children:s.clinicName})})]},s.id))})]})}function ne(){const[d,n]=p.useState(!1),[l,t]=p.useState(!1),{searchQuery:c}=v(),[i,a]=p.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),{clinics:m,addDoctor:u,isAddingDoctor:s}=E(),h=C(),D=()=>{!m||m.length===0?t(!0):n(!0)},N=async()=>{if(i.firstName.trim()&&i.lastName.trim()&&i.email.trim()&&i.phoneNumber.trim())try{await u({clinicId:parseInt(i.selectedClinic),firstName:i.firstName.trim(),lastName:i.lastName.trim(),email:i.email.trim(),address:i.address.trim(),phoneNumber:i.phoneNumber.trim()}),a({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),n(!1)}catch(y){console.error("Error adding doctor:",y)}};return e.jsxs(S,{pt:12,maw:1232,fluid:!0,children:[e.jsxs(z,{title:e.jsx(o,{fz:"lg",fw:700,children:"There is no Clinics"}),radius:"md",closeButtonProps:{radius:"xl"},centered:!0,opened:l,onClose:()=>t(!1),size:"md",children:[e.jsx(o,{fz:"sm",children:"You must create at least one clinic before adding a doctor."}),e.jsxs(x,{justify:"end",mt:"xl",children:[e.jsx(f,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(f,{bg:I.primaryColor,variant:"filled",onClick:()=>h("/clinics"),children:"Go to Clinics"})]})]}),e.jsxs(j,{children:[e.jsx(H,{fz:"24px",order:2,children:"Doctors"}),e.jsx(x,{mt:40,justify:"flex-end",children:e.jsx(f,{size:"lg",variant:"outline",leftSection:e.jsx(M,{size:20}),onClick:D,radius:"xl",children:"New Doctor"})}),e.jsx(L,{radius:"md",withBorder:!0,children:e.jsx(R,{searchQuery:c})}),e.jsx(P,{opened:d,onClose:()=>n(!1),onSubmit:N,doctorData:i,setDoctorData:a,isLoading:s})]})]})}export{ne as default};
