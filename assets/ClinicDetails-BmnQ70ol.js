import{j as e,W as G,S as l,T as t,G as n,F as j,C as g,L as U,A as h,o as Q,Y as N,P as D}from"./ui-60GCj8Dw.js";import{e as R,u as W,r as m}from"./router-DP3ythCP.js";import{u as X}from"./appointments-B_6-NBdq.js";import{h as x}from"./chat-CG0hw1Kq.js";import{C as Y}from"./CreateDoctorDrawer-qbaD1lli.js";import{r as H,f as J,q as K,m as V,n as Z,G as _,s as $,h as ee,t as ie}from"./icons-BQympANv.js";import"./vendor-DJG_os-6.js";import"./query-D3UiA-xa.js";import"./doctors-BuBJrB5C.js";function re({isOpen:s,onClose:c,onConfirm:r,title:u,itemName:p,isLoading:d}){return e.jsx(G,{opened:s,onClose:c,title:e.jsx(t,{fw:700,children:u}),centered:!0,children:e.jsxs(l,{children:[e.jsxs(t,{size:"sm",children:["Are you sure you want to delete ",p,"? This action cannot be undone."]}),e.jsxs(n,{justify:"flex-end",mt:"md",children:[e.jsx(j,{variant:"light",onClick:c,children:"Cancel"}),e.jsx(j,{variant:"outline",color:"red",onClick:r,loading:d,children:"Delete"})]})]})})}function ue(){const{id:s}=R(),c=W(),[r,u]=m.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:s?s.toString():""}),[p,d]=m.useState(!1),[a,f]=m.useState(""),[S,C]=m.useState(!1),[v,b]=m.useState(!1),{clinic:o,doctors:w,isLoading:E,isError:y,error:k,addDoctor:A,updateClinic:L,deleteClinic:T,isAddingDoctor:q,isUpdating:M,isDeleting:I}=X(Number(s)),O=async()=>{if(!r.firstName.trim()){x.error("Error","Doctor first name is required");return}if(!r.lastName.trim()){x.error("Error","Doctor last name is required");return}if(!r.email.trim()){x.error("Error","Doctor email is required");return}if(!r.phoneNumber.trim()){x.error("Error","Doctor phone number is required");return}const i={clinicId:Number(s),firstName:r.firstName.trim(),lastName:r.lastName.trim(),email:r.email.trim(),address:r.address.trim(),phoneNumber:r.phoneNumber.trim()};await A(i),u({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:s?s.toString():""})},P=()=>{f(o.name),d(!0)},z=()=>{f(""),d(!1)},B=async()=>{if(!a.trim()||a===o.name){z();return}try{await L({id:Number(s),name:a.trim()}),d(!1)}catch(i){console.error("Failed to update clinic name:",i)}},F=async()=>{try{await T(Number(s)),c("/clinics")}catch(i){console.error("Failed to delete clinic:",i)}};return y?e.jsx(g,{children:e.jsxs(t,{c:"red",children:["Error: ",k.message]})}):o?e.jsxs(g,{ml:100,pt:20,maw:800,fluid:!0,children:[e.jsx(U,{visible:E}),e.jsx(re,{isOpen:S,onClose:()=>C(!1),onConfirm:F,title:"Delete Clinic",itemName:o.name,isLoading:I}),e.jsxs(l,{gap:"xl",children:[e.jsxs(n,{justify:"space-between",children:[e.jsxs(n,{children:[e.jsx(h,{hiddenFrom:"sm",variant:"subtle",onClick:()=>c("/clinics"),size:"lg",children:e.jsx(H,{size:20})}),p?e.jsxs(n,{children:[e.jsx(Q,{value:a,onChange:i=>f(i.target.value),error:a.trim()?null:"Name is required"}),e.jsx(h,{color:"green",onClick:B,loading:M,disabled:!a.trim()||a===o.name,children:e.jsx(J,{size:20})}),e.jsx(h,{color:"red",onClick:z,children:e.jsx(K,{size:20})})]}):e.jsxs(n,{children:[e.jsx(N,{order:2,children:o.name}),e.jsx(h,{variant:"subtle",onClick:P,children:e.jsx(V,{size:20})})]})]}),e.jsx(j,{color:"red",variant:"outline",leftSection:e.jsx(Z,{size:16}),onClick:()=>C(!0),loading:I,children:"Delete Clinic"})]}),e.jsx(D,{withBorder:!0,p:"md",radius:"md",children:e.jsxs(l,{gap:"md",children:[e.jsx(N,{order:3,children:"Basic Information"}),e.jsx(t,{children:"This section can be used for additional clinic information."})]})}),e.jsx(D,{withBorder:!0,p:"md",radius:"md",children:e.jsxs(l,{gap:"md",children:[e.jsxs(n,{justify:"space-between",children:[e.jsx(N,{order:3,children:"Doctors"}),e.jsx(j,{variant:"outline",leftSection:e.jsx(_,{size:16}),onClick:()=>b(!0),children:"Add Doctor"})]}),w.length===0?e.jsx(t,{c:"dimmed",children:"No doctors assigned to this clinic"}):e.jsx(l,{gap:"xs",children:w.map(i=>e.jsx(D,{withBorder:!0,p:"md",radius:"lg",bg:"gray.0",children:e.jsxs(l,{gap:"xs",children:[e.jsx(n,{justify:"space-between",children:e.jsx(t,{fw:500,size:"lg",children:i.name})}),i.email&&e.jsxs(n,{gap:"xs",children:[e.jsx($,{size:16}),e.jsx(t,{size:"sm",children:i.email})]}),i.phoneNumber&&e.jsxs(n,{gap:"xs",children:[e.jsx(ee,{size:16}),e.jsx(t,{size:"sm",children:i.phoneNumber})]}),i.address&&e.jsxs(n,{gap:"xs",children:[e.jsx(ie,{size:16}),e.jsx(t,{size:"sm",children:i.address})]})]})},i.id))})]})}),e.jsx(Y,{opened:v,onClose:()=>b(!1),onSubmit:O,doctorData:r,setDoctorData:u,isLoading:q,clinicId:Number(s)})]})]}):e.jsx(g,{children:e.jsx(t,{children:"Loading clinic details..."})})}export{ue as default};
