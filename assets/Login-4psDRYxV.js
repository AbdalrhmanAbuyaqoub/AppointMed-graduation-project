import{w as y,j as e,S as w,aa as v,T as u,ab as p,o as z,F as C,C as E,a2 as F,P as I,L as T,G as f,ac as M,ad as B}from"./ui-60GCj8Dw.js";import{r as m,u as V,d as q}from"./router-DP3ythCP.js";import{u as A}from"./useStore-CNwvYjxm.js";import{u as L,n as b,t as W}from"./chat-CG0hw1Kq.js";import{S as R}from"./index-ByRwRPFN.js";import{s as G,E as j,f as k,F as S}from"./icons-BQympANv.js";import"./vendor-DJG_os-6.js";import"./query-D3UiA-xa.js";import"./appointments-B_6-NBdq.js";const N=({onBackToLogin:l})=>{const[t,a]=m.useState(!1),[x,c]=m.useState(!1),{handleForgotPassword:g}=L(),i=y({initialValues:{email:""},validate:{email:o=>o?/^\S+@\S+$/.test(o)?null:"Invalid email address":"Email is required"}}),h=async o=>{a(!0);try{const d=await g(o.email);d.success?(c(!0),b.show({title:"Success",message:d.message,color:"green",icon:e.jsx(k,{size:16})}),i.reset()):b.show({title:"Error",message:d.error,color:"red",icon:e.jsx(S,{size:16})})}catch{b.show({title:"Error",message:"An unexpected error occurred. Please try again.",color:"red",icon:e.jsx(S,{size:16})})}a(!1)},r=()=>{c(!1),i.reset(),l()};return x?e.jsxs(w,{children:[e.jsx(v,{icon:e.jsx(G,{size:16}),title:"Email Sent",color:"green",variant:"light",children:"We've sent a new password to your email address. Please check your inbox and use the new password to log in."}),e.jsx(u,{ta:"center",size:"sm",mt:"md",children:e.jsxs(p,{component:"button",type:"button",onClick:r,fw:500,disabled:t,style:{display:"inline-flex",alignItems:"center",gap:"4px"},children:[e.jsx(j,{size:16}),"Back to Login"]})})]}):e.jsx("form",{onSubmit:i.onSubmit(h),children:e.jsxs(w,{children:[e.jsx(z,{required:!0,radius:"md",label:"Email Address",placeholder:"your@email.com",value:i.values.email,onChange:o=>i.setFieldValue("email",o.currentTarget.value),error:i.errors.email,disabled:t,size:"md"}),e.jsx(u,{size:"sm",c:"dimmed",ta:"center",children:"We'll send you a new password to your email address."}),e.jsx(C,{type:"submit",radius:"xl",fullWidth:!0,loading:t,disabled:!i.values.email,size:"lg",mt:"md",children:"Send New Password"}),e.jsx(u,{ta:"center",size:"sm",mt:"md",children:e.jsxs(p,{component:"button",type:"button",onClick:r,fw:500,disabled:t,style:{display:"inline-flex",alignItems:"center",gap:"4px"},children:[e.jsx(j,{size:16}),"Back to Login"]})})]})})},X=()=>{const l=V(),t=q(),a=A(s=>s.isLoading),{handleLogin:x}=L(),[c,g]=m.useState("login"),[i,h]=m.useState(""),r=y({initialValues:{email:"",password:"",rememberMe:!1},validate:{email:s=>s?/^\S+@\S+$/.test(s)?null:"Invalid email address":"Email is required",password:s=>s?null:"Password is required"}});m.useEffect(()=>{var s;(s=t.state)!=null&&s.message&&(h(t.state.message),t.state.email&&r.setFieldValue("email",t.state.email),l(t.pathname,{replace:!0}))},[t.state,l,r]);const o=async s=>{try{const n=await x({email:s.email,password:s.password,rememberMe:s.rememberMe});if(!(n!=null&&n.success))throw new Error((n==null?void 0:n.error)||"Login failed")}catch(n){console.error("Login error:",n)}},d=()=>{g("forgot-password")},P=()=>{g("login")};return e.jsxs(E,{w:"100vw",h:"100vh",fluid:!0,bg:W.backgroundColor,children:[e.jsx(F,{h:"50"}),e.jsxs(I,{withBorder:!0,shadow:"md",radius:"lg",p:"xl",w:"100%",maw:400,mx:"auto",pos:"relative",children:[e.jsx(T,{visible:a,overlayProps:{blur:2}}),e.jsx(f,{pb:"md",justify:"center",children:e.jsx(R,{height:60,width:60,onClick:()=>l("/"),cursor:"pointer"})}),e.jsx(u,{size:"xl",ta:"center",mb:"xl",fw:500,children:c==="login"?"Login to your account":"Reset Your Password"}),i&&e.jsx(v,{icon:e.jsx(k,{size:16}),title:"Success",color:"green",variant:"light",mb:"md",withCloseButton:!0,onClose:()=>h(""),children:i}),c==="login"?e.jsx("form",{onSubmit:r.onSubmit(o),children:e.jsxs(w,{gap:"md",children:[e.jsx(z,{required:!0,label:"Email",placeholder:"your@email.com",value:r.values.email,onChange:s=>r.setFieldValue("email",s.currentTarget.value),error:r.errors.email,radius:"md",disabled:a,size:"md"}),e.jsx(M,{required:!0,label:"Password",placeholder:"Your password",value:r.values.password,onChange:s=>r.setFieldValue("password",s.currentTarget.value),error:r.errors.password,radius:"md",disabled:a,size:"md"}),e.jsx(B,{label:"Remember me",checked:r.values.rememberMe,onChange:s=>r.setFieldValue("rememberMe",s.currentTarget.checked),disabled:a,size:"sm"}),e.jsx(f,{justify:"flex-end",children:e.jsx(p,{component:"button",type:"button",onClick:d,size:"sm",disabled:a,children:"Forgot Password?"})}),e.jsx(C,{type:"submit",radius:"xl",fullWidth:!0,loading:a,size:"lg",mt:"md",children:"Sign in"}),e.jsxs(u,{ta:"center",size:"sm",mt:"md",children:["Don't have an account?"," ",e.jsx(p,{component:"button",type:"button",onClick:()=>l("/register"),fw:500,disabled:a,children:"Sign up"})]})]})}):e.jsx(N,{onBackToLogin:P})]})]})};export{X as default};
