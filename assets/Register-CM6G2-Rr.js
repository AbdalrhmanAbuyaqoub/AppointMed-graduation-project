import{l as e,u as s,x as t,a,J as r,r as o,m as i,j as l,G as n,n as c,K as d,c as p,v as u,M as m,N as h,O as g,U as v,q as f,Q as y,R as x,B as b,V as j,W as w,g as S,X as C,s as z,d as N,y as P,C as I,t as E,F as k,P as _,L as F,H as V,T as q,f as T,z as D,e as A,Y as R,D as L}from"./index-C5KYdp5U.js";import{u as $,A as B,I as W}from"./useStore-Dvde7V8v.js";import{u as M}from"./use-form-B7Ieu88Z.js";import{g as K}from"./get-auto-contrast-value-CGWe5n6U.js";import{a as O}from"./CheckIcon-C078fXa_.js";import{A as J,P as Y}from"./PasswordInput-edyXT4tv.js";import{I as Z}from"./IconMail-BL6ruXOu.js";import{I as G}from"./IconCheck-fnBUfSad.js";import"./ActionIcon-Dw2MUdTV.js";function H(e,s){if(e<1)return[];const t=new Array(e).fill("");if(s){const a=s.trim().split("");for(let s=0;s<Math.min(e,a.length);s+=1)t[s]=" "===a[s]?"":a[s]}return t}var Q={root:"m_f1cb205a",pinInput:"m_cb288ead"};const U={number:/^[0-9]+$/,alphanumeric:/^[a-zA-Z0-9]+$/i},X={gap:"sm",length:4,manageFocus:!0,oneTimeCode:!0,placeholder:"○",type:"alphanumeric",ariaLabel:"PinInput"},ee=p((e,{size:s})=>({root:{"--pin-input-size":u(s??X.size,"pin-input-size")}})),se=e((e,p)=>{const{name:u,form:m,className:h,value:g,defaultValue:v,variant:f,gap:y,style:x,size:b,classNames:j,styles:w,unstyled:S,length:C,onChange:z,onComplete:N,manageFocus:P,autoFocus:I,error:E,radius:k,disabled:_,oneTimeCode:F,placeholder:V,type:q,mask:T,readOnly:D,inputType:A,inputMode:R,ariaLabel:L,vars:$,id:B,hiddenInputProps:W,rootRef:M,getInputProps:K,...O}=s("PinInput",X,e),J=t(B),Y=a({name:"PinInput",classes:Q,props:e,className:h,style:x,classNames:j,styles:w,unstyled:S,vars:$,varsResolver:ee}),{resolvedClassNames:Z,resolvedStyles:G}=r({classNames:j,styles:w,props:e}),[se,te]=o.useState(-1),[ae,re]=i({value:g?H(C??0,g):void 0,defaultValue:null==v?void 0:v.split("").slice(0,C??0),finalValue:H(C??0,""),onChange:"function"==typeof z?e=>{z(e.join("").trim())}:void 0}),oe=ae.join("").trim(),ie=o.useRef([]),le=e=>{const s=q instanceof RegExp?q:q&&q in U?U[q]:null;return null==s?void 0:s.test(e)},ne=(e,s,t)=>{if(P){if("next"===e){const e=s+1;e<(C??0)&&(null==t||t.preventDefault(),ie.current[e].focus())}if("prev"===e){const e=s-1;e>-1&&(null==t||t.preventDefault(),ie.current[e].focus())}}else null==t||t.preventDefault()},ce=(e,s)=>{const t=[...ae];t[s]=e,re(t)},de=()=>{te(-1)},pe=e=>{e.preventDefault();const s=e.clipboardData.getData("text/plain").replace(/[\n\r\s]+/g,"");if(le(s.trim())){const e=H(C??0,s);re(e),ne("next",e.length-2)}};return o.useEffect(()=>{oe.length===C&&(null==N||N(oe))},[C,oe]),o.useEffect(()=>{C!==ae.length&&re(H(C??0,ae.join("")))},[C,ae]),o.useEffect(()=>{""===g&&re(H(C??0,g))},[g]),o.useEffect(()=>{_&&te(-1)},[_]),l.jsxs(l.Fragment,{children:[l.jsx(n,{...O,...Y("root"),ref:M,role:"group",id:J,gap:y,unstyled:S,wrap:"nowrap",variant:f,__size:b,dir:"ltr",children:ae.map((e,s)=>o.createElement(c,{component:"input",...Y("pinInput",{style:{"--input-padding":"0","--input-text-align":"center"}}),classNames:Z,styles:G,size:b,__staticSelector:"PinInput",id:`${J}-${s+1}`,key:`${J}-${s}`,inputMode:R||("number"===q?"numeric":"text"),onChange:e=>((e,s)=>{const t=e.target.value,a=2===t.length?t.split("")[t.length-1]:t,r=le(a);a.length<2?r?(ce(a,s),ne("next",s)):ce("",s):r&&re(H(C??0,t))})(e,s),onKeyDown:e=>((e,s)=>{const{ctrlKey:t,metaKey:a,key:r,shiftKey:o,target:i}=e,l=i.value;"numeric"===R&&("Backspace"===r||"Tab"===r||"Control"===r||"Delete"===r||t&&"v"===r||a&&"v"===r||!Number.isNaN(Number(r))||e.preventDefault());"ArrowLeft"===r||o&&"Tab"===r?ne("prev",s,e):"ArrowRight"===r||"Tab"===r||" "===r?ne("next",s,e):"Delete"===r?ce("",s):"Backspace"===r?0!==s&&(ce("",s),C===s+1?""===e.target.value&&ne("prev",s,e):ne("prev",s,e)):l.length>0&&r===ae[s]&&ne("next",s,e)})(e,s),onFocus:e=>((e,s)=>{e.target.select(),te(s)})(e,s),onBlur:de,onPaste:pe,type:A||(T?"password":"number"===q?"tel":"text"),radius:k,error:E,variant:f,disabled:_,ref:e=>{0===s&&d(p,e),ie.current[s]=e},autoComplete:F?"one-time-code":"off",placeholder:se===s?"":V,value:e,autoFocus:I&&0===s,unstyled:S,"aria-label":L,readOnly:D,...null==K?void 0:K(s)}))}),l.jsx("input",{type:"hidden",name:u,form:m,value:oe,...W})]})});se.classes={...Q,...m.classes},se.displayName="@mantine/core/PinInput";const[te,ae]=h("Stepper component was not found in tree"),re=()=>null;re.displayName="@mantine/core/StepperCompleted";var oe={root:"m_cbb4ea7e",steps:"m_aaf89d0b",separator:"m_2a371ac9",content:"m_78da155d",step:"m_cbb57068","step--horizontal":"m_f56b1e2c","step--vertical":"m_833edb7e",verticalSeparator:"m_6496b3f3",stepWrapper:"m_818e70b",stepIcon:"m_1959ad01",stepCompletedIcon:"m_a79331dc",stepBody:"m_1956aa2a",stepLabel:"m_12051f6c",stepDescription:"m_164eea74"};const ie=(e,s)=>"function"==typeof e?l.jsx(e,{step:s||0}):e,le={withIcon:!0,allowStepClick:!0,iconPosition:"left"},ne=e((e,t)=>{const{classNames:a,className:r,style:o,styles:i,vars:n,step:c,state:d,color:p,icon:u,completedIcon:m,progressIcon:h,label:b,description:j,withIcon:w,iconSize:S,loading:C,allowStepClick:z,allowStepSelect:N,iconPosition:P,orientation:I,mod:E,...k}=s("StepperStep",le,e),_=ae(),F=g(),V={classNames:a,styles:i},q="stepCompleted"===d?null:"stepProgress"===d?h:u,T={"data-progress":"stepProgress"===d||void 0,"data-completed":"stepCompleted"===d||void 0};return l.jsxs(v,{..._.getStyles("step",{className:r,style:o,variant:_.orientation,...V}),mod:[{"icon-position":P||_.iconPosition,"allow-click":z},E],ref:t,...T,...k,__vars:{"--step-color":p?f(p,F):void 0},tabIndex:z?0:-1,children:[w&&l.jsxs("span",{..._.getStyles("stepWrapper",V),children:[l.jsxs("span",{..._.getStyles("stepIcon",V),...T,children:[l.jsx(y,{mounted:"stepCompleted"===d,transition:"pop",duration:200,children:e=>l.jsx("span",{..._.getStyles("stepCompletedIcon",{style:e,...V}),children:C?l.jsx(x,{color:"var(--mantine-color-white)",size:"calc(var(--stepper-icon-size) / 2)",..._.getStyles("stepLoader",V)}):ie(m,c)||l.jsx(O,{size:"60%"})})}),"stepCompleted"!==d?C?l.jsx(x,{..._.getStyles("stepLoader",V),size:"calc(var(--stepper-icon-size) / 2)",color:p}):ie(q||u,c):null]}),"vertical"===I&&l.jsx("span",{..._.getStyles("verticalSeparator",V),"data-active":"stepCompleted"===d||void 0})]}),(b||j)&&l.jsxs("span",{..._.getStyles("stepBody",V),"data-orientation":_.orientation,"data-icon-position":P||_.iconPosition,children:[b&&l.jsx("span",{..._.getStyles("stepLabel",V),children:ie(b,c)}),j&&l.jsx("span",{..._.getStyles("stepDescription",V),children:ie(j,c)})]})]})});ne.classes=oe,ne.displayName="@mantine/core/StepperStep";const ce={orientation:"horizontal",iconPosition:"left",allowNextStepsSelect:!0,wrap:!0},de=p((e,{color:s,iconSize:t,size:a,contentPadding:r,radius:o,autoContrast:i})=>({root:{"--stepper-color":s?f(s,e):void 0,"--stepper-icon-color":K(i,e)?z({color:s,theme:e,autoContrast:i}):void 0,"--stepper-icon-size":void 0===t?u(a,"stepper-icon-size"):C(t),"--stepper-content-padding":j(r),"--stepper-radius":void 0===o?void 0:S(o),"--stepper-fz":w(a),"--stepper-spacing":j(a)}})),pe=e((e,t)=>{var r,i,n;const c=s("Stepper",ce,e),{classNames:d,className:p,style:u,styles:m,unstyled:h,vars:g,children:v,onStepClick:f,active:y,icon:x,completedIcon:j,progressIcon:w,color:S,iconSize:C,contentPadding:z,orientation:N,iconPosition:P,size:I,radius:E,allowNextStepsSelect:k,wrap:_,autoContrast:F,...V}=c,q=a({name:"Stepper",classes:oe,props:c,className:p,style:u,classNames:d,styles:m,unstyled:h,vars:g,varsResolver:de}),T=o.Children.toArray(v),D=T.filter(e=>e.type!==re),A=T.find(e=>e.type===re),R=D.reduce((e,s,t)=>{const a=y===t?"stepProgress":y>t?"stepCompleted":"stepInactive",r="function"==typeof f&&("boolean"==typeof s.props.allowStepSelect?s.props.allowStepSelect:"stepCompleted"===a||k);return e.push(o.cloneElement(s,{icon:s.props.icon||x||t+1,key:t,step:t,state:a,onClick:()=>r&&(null==f?void 0:f(t)),allowStepClick:r,completedIcon:s.props.completedIcon||j,progressIcon:s.props.progressIcon||w,color:s.props.color||S,iconSize:C,iconPosition:s.props.iconPosition||P,orientation:N})),"horizontal"===N&&t!==D.length-1&&e.push(o.createElement("div",{...q("separator"),"data-active":t<y||void 0,"data-orientation":N,key:`separator-${t}`})),e},[]),L=null==(i=null==(r=D[y])?void 0:r.props)?void 0:i.children,$=null==(n=null==A?void 0:A.props)?void 0:n.children,B=y>D.length-1?$:L;return l.jsx(te,{value:{getStyles:q,orientation:N,iconPosition:P},children:l.jsxs(b,{...q("root"),ref:t,size:I,...V,children:[l.jsx(b,{...q("steps"),mod:{orientation:N,"icon-position":P,wrap:_&&"vertical"!==N},children:R}),B&&l.jsx("div",{...q("content"),children:B})]})})});pe.classes=oe,pe.displayName="@mantine/core/Stepper",pe.Completed=re,pe.Step=ne;const ue=()=>{const e=N(),s=$(e=>e.isLoading),{handleRegister:t}=P(),[a,r]=o.useState(0),[i,c]=o.useState(""),[d,p]=o.useState(!1),[u,m]=o.useState(!1),[h,g]=o.useState(0),[v,f]=o.useState(!1),y=M({initialValues:{email:"",password:"",firstName:"",lastName:"",confirmPassword:"",address:"",phoneNumber:""},validate:{email:e=>e?/^\S+@\S+$/.test(e)?null:"Invalid email address":"Email is required",password:e=>e?e.length<6?"Password must be at least 6 characters":/[A-Z]/.test(e)?/[a-z]/.test(e)?/[0-9]/.test(e)?null:"Password must contain at least one number":"Password must contain at least one lowercase letter":"Password must contain at least one uppercase letter":"Password is required",confirmPassword:(e,s)=>e!==s.password?"Passwords do not match":e?null:"Please confirm your password",firstName:e=>e?null:"First Name is required",lastName:e=>e?null:"Last Name is required",address:e=>e?null:"Address is required",phoneNumber:e=>e?null:"Phone Number is required"}});o.useEffect(()=>{if(h>0){const e=setTimeout(()=>g(h-1),1e3);return()=>clearTimeout(e)}},[h]);return l.jsxs(I,{w:"100vw",h:"100vh",fluid:!0,bg:E.backgroundColor,children:[l.jsx(k,{h:"50"}),l.jsxs(_,{withBorder:!0,shadow:"md",radius:"lg",p:"xl",mx:"auto",w:"600",children:[l.jsx(F,{visible:s||d,overlayProps:{blur:2}}),l.jsx(n,{pb:"md",justify:"center",children:l.jsx(V,{height:60,width:60,onClick:()=>e("/"),style:{cursor:"pointer"}})}),l.jsx(q,{size:"30px",ta:"center",mb:"md",fw:500,children:"Create an account"}),l.jsxs(pe,{active:a,breakpoint:"sm",mb:"xl",children:[l.jsx(pe.Step,{label:"Email",description:"Enter your email",children:"Step 1: Email verification"}),l.jsx(pe.Step,{label:"Verify",description:"Verify code",children:"Step 2: Email verification"}),l.jsx(pe.Step,{label:"Complete",description:"Finish registration",children:"Step 3: Complete registration"})]}),0===a&&l.jsxs(T,{gap:"lg",children:[l.jsx(D,{size:"md",required:!0,label:"Email",placeholder:"your@email.com",value:y.values.email,onChange:e=>y.setFieldValue("email",e.currentTarget.value),error:y.errors.email,radius:"md",disabled:s}),l.jsx(A,{size:"lg",radius:"xl",fullWidth:!0,onClick:async()=>{if(!y.validateField("email").hasError)try{const e=await R.sendVerificationCode(y.values.email);e.success?(r(1),g(60),L.show({title:"Code Sent",message:e.message,color:"green",icon:l.jsx(Z,{size:16})})):L.show({title:"Error",message:e.error,color:"red",icon:l.jsx(W,{size:16})})}catch(e){L.show({title:"Error",message:"Failed to send verification code. Please try again.",color:"red",icon:l.jsx(W,{size:16})})}},loading:s,disabled:!y.values.email,children:"Send Verification Code"}),l.jsxs(q,{ta:"center",size:"sm",children:["Already have an account?"," ",l.jsx(B,{component:"button",type:"button",onClick:()=>e("/login"),fw:500,disabled:s,children:"Sign in"})]})]}),1===a&&l.jsxs(T,{gap:"lg",children:[l.jsxs(J,{icon:l.jsx(Z,{size:16}),variant:"light",children:["We've sent a 6-digit verification code to"," ",l.jsx(q,{component:"span",fw:500,children:y.values.email}),". Please check your inbox."]}),l.jsx(n,{justify:"center",children:l.jsx(se,{length:6,value:i,onChange:c,size:"lg",type:"number",placeholder:"○",disabled:d})}),l.jsx(A,{size:"lg",radius:"xl",fullWidth:!0,onClick:async()=>{if(6===i.length){p(!0);try{const e=await R.verifyCode(y.values.email,i);e.success?(f(!0),r(2),L.show({title:"Email Verified",message:"Email verified successfully! Complete your registration.",color:"green",icon:l.jsx(G,{size:16})})):L.show({title:"Verification Failed",message:e.error,color:"red",icon:l.jsx(W,{size:16})})}catch(e){L.show({title:"Error",message:"An unexpected error occurred. Please try again.",color:"red",icon:l.jsx(W,{size:16})})}p(!1)}else L.show({title:"Invalid Code",message:"Please enter a 6-digit verification code",color:"red",icon:l.jsx(W,{size:16})})},loading:d,disabled:6!==i.length,children:"Verify Code"}),l.jsxs(n,{justify:"center",gap:"xs",children:[l.jsx(q,{size:"sm",c:"dimmed",children:"Didn't receive the code?"}),l.jsx(A,{variant:"subtle",size:"sm",onClick:async()=>{if(!(h>0)){m(!0);try{const e=await R.sendVerificationCode(y.values.email);e.success?(L.show({title:"Code Sent",message:e.message,color:"green",icon:l.jsx(Z,{size:16})}),g(60)):L.show({title:"Error",message:e.error,color:"red",icon:l.jsx(W,{size:16})})}catch(e){L.show({title:"Error",message:"Failed to resend verification code. Please try again.",color:"red",icon:l.jsx(W,{size:16})})}m(!1)}},loading:u,disabled:h>0,children:h>0?`Resend in ${h}s`:"Resend Code"})]}),l.jsx(A,{variant:"subtle",onClick:()=>r(0),disabled:d,children:"← Change Email"})]}),2===a&&l.jsx("form",{onSubmit:y.onSubmit(async e=>{if(v)try{const s=await t({email:e.email,password:e.password,firstName:e.firstName,lastName:e.lastName,confirmPassword:e.confirmPassword,address:e.address,phoneNumber:e.phoneNumber});if(!(null==s?void 0:s.success))throw new Error((null==s?void 0:s.error)||"Registration failed")}catch(s){}else L.show({title:"Email Not Verified",message:"Please verify your email before completing registration.",color:"red",icon:l.jsx(W,{size:16})})}),children:l.jsxs(T,{gap:"md",children:[l.jsx(J,{icon:l.jsx(G,{size:16}),color:"green",variant:"light",mb:"md",children:"Email verified successfully! Complete your registration below."}),l.jsxs(n,{grow:!0,children:[l.jsx(D,{size:"md",required:!0,label:"First Name",placeholder:"e.g. John",value:y.values.firstName,onChange:e=>y.setFieldValue("firstName",e.currentTarget.value),error:y.errors.firstName,radius:"md",disabled:s}),l.jsx(D,{size:"md",required:!0,label:"Last Name",placeholder:"e.g. Doe",value:y.values.lastName,onChange:e=>y.setFieldValue("lastName",e.currentTarget.value),error:y.errors.lastName,radius:"md",disabled:s})]}),l.jsx(D,{size:"md",required:!0,label:"Phone Number",placeholder:"e.g. 09123456789",value:y.values.phoneNumber,onChange:e=>y.setFieldValue("phoneNumber",e.currentTarget.value),error:y.errors.phoneNumber,radius:"md",disabled:s}),l.jsx(D,{size:"md",required:!0,label:"Address",placeholder:"e.g. Main St, Nablus, Palestine",value:y.values.address,onChange:e=>y.setFieldValue("address",e.currentTarget.value),error:y.errors.address,radius:"md",disabled:s}),l.jsx(D,{size:"md",required:!0,label:"Email",value:y.values.email,radius:"md",disabled:!0}),l.jsx(Y,{size:"md",required:!0,label:"Password",placeholder:"Your password",value:y.values.password,onChange:e=>y.setFieldValue("password",e.currentTarget.value),error:y.errors.password,radius:"md",disabled:s}),l.jsx(Y,{size:"md",required:!0,label:"Confirm Password",placeholder:"Confirm your password",value:y.values.confirmPassword,onChange:e=>y.setFieldValue("confirmPassword",e.currentTarget.value),error:y.errors.confirmPassword,radius:"md",disabled:s}),l.jsx(A,{mt:"lg",type:"submit",radius:"xl",size:"lg",fullWidth:!0,loading:s,children:"Complete Registration"}),l.jsxs(q,{ta:"center",size:"sm",children:["Already have an account?"," ",l.jsx(B,{component:"button",type:"button",onClick:()=>e("/login"),fw:500,disabled:s,children:"Sign in"})]})]})})]})]})};export{ue as default};
