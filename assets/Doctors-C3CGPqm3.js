import{aq as T,d as C,j as e,f,i as k,h as o,G as x,ab as w,ao as b,B as v,r as j,aG as S,aH as z,C as I,aF as L,e as p,t as A,T as O,at as B,P as W,aZ as G}from"./index-ZwLsdpq7.js";import{u as H,D as P}from"./useWorkingHoursQueries-4Kg8ESMa.js";import{S as g,I as E}from"./IconUserOff-DbUXZZJf.js";import{T as r}from"./Table-C_2zmgBg.js";import"./appointmentService-IRgsPcX5.js";function M({doctorId:m,workingDays:n}){const c=n.length===0?[0,1,2,3,4,5,6]:n;return e.jsx(x,{gap:"8",children:P.map(t=>{const d=c.includes(t.value);return e.jsx(v,{bg:d?"violet":"gray.4",fw:500,p:4,h:24,w:24,style:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},title:t.day,children:e.jsx(o,{size:"xs",fw:500,c:"white",children:t.letter})},t.value)})})}function Q({searchQuery:m=""}){const{doctors:n,isLoading:c}=T(),{doctorsWorkingDays:t,isLoading:d}=H(),i=C(),a=s=>{i(`/doctors/${s}`)},u=s=>{i(`/clinics/${s}`)},h=n.filter(s=>{const l=m.toLowerCase();return s.name.toLowerCase().includes(l)||s.clinicName.toLowerCase().includes(l)});return c||d?e.jsxs(f,{children:[e.jsx(g,{height:40,radius:"sm"}),[1,2,3].map(s=>e.jsx(g,{height:50,radius:"sm",mt:"sm"},s))]}):e.jsxs(r,{highlightOnHover:!0,verticalSpacing:"sm",horizontalSpacing:"lg",children:[e.jsx(r.Thead,{children:e.jsxs(r.Tr,{children:[e.jsx(r.Th,{c:"dimmed",children:"Name"}),e.jsx(r.Th,{c:"dimmed",children:"Working Days"}),e.jsx(r.Th,{c:"dimmed",children:"Clinic"})]})}),e.jsx(r.Tbody,{children:h.length===0?e.jsx(r.Tr,{children:e.jsx(r.Td,{colSpan:3,children:e.jsx(k,{py:"xl",children:e.jsxs(f,{align:"center",gap:"md",children:[e.jsx(E,{size:30,opacity:.4}),e.jsx(o,{size:"sm",c:"dimmed",children:"No doctors found"})]})})})}):h.map(s=>e.jsxs(r.Tr,{style:{cursor:"pointer"},onClick:()=>a(s.id),children:[e.jsx(r.Td,{children:e.jsxs(x,{gap:"sm",children:[e.jsx(w,{color:"#e7edf6",style:{cursor:"pointer"},onClick:()=>a(s.id),size:"md",radius:"xl",variant:"filled",children:e.jsx(o,{fz:"sm",children:s.name.split(" ").map(l=>l[0]).join("").toUpperCase()})}),e.jsx(o,{size:"sm",fw:600,style:{cursor:"pointer"},onClick:()=>a(s.id),children:s.name})]})}),e.jsx(r.Td,{children:e.jsx(M,{doctorId:s.id,workingDays:t[s.id]||[]})}),e.jsx(r.Td,{children:e.jsx(b,{variant:"light",size:"lg",radius:"sm",px:"md",style:{cursor:"pointer"},onClick:()=>u(s.clinicId),children:s.clinicName})})]},s.id))})]})}function q(){const[m,n]=j.useState(!1),[c,t]=j.useState(!1),{searchQuery:d}=S(),[i,a]=j.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),{clinics:u,addDoctor:h,isAddingDoctor:s}=z(),l=C(),D=()=>{!u||u.length===0?t(!0):n(!0)},N=async()=>{if(i.firstName.trim()&&i.lastName.trim()&&i.email.trim()&&i.phoneNumber.trim())try{await h({clinicId:parseInt(i.selectedClinic),firstName:i.firstName.trim(),lastName:i.lastName.trim(),email:i.email.trim(),address:i.address.trim(),phoneNumber:i.phoneNumber.trim()}),a({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),n(!1)}catch(y){console.error("Error adding doctor:",y)}};return e.jsxs(I,{pt:12,maw:1232,fluid:!0,children:[e.jsxs(L,{title:e.jsx(o,{fz:"lg",fw:700,children:"There is no Clinics"}),radius:"md",closeButtonProps:{radius:"xl"},centered:!0,opened:c,onClose:()=>t(!1),size:"md",children:[e.jsx(o,{fz:"sm",children:"You must create at least one clinic before adding a doctor."}),e.jsxs(x,{justify:"end",mt:"xl",children:[e.jsx(p,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),e.jsx(p,{bg:A.primaryColor,variant:"filled",onClick:()=>l("/clinics"),children:"Go to Clinics"})]})]}),e.jsxs(f,{children:[e.jsx(O,{fz:"24px",order:2,children:"Doctors"}),e.jsx(x,{mt:40,justify:"flex-end",children:e.jsx(p,{size:"lg",variant:"outline",leftSection:e.jsx(B,{size:20}),onClick:D,radius:"xl",children:"Add New Doctor"})}),e.jsx(W,{radius:"md",withBorder:!0,children:e.jsx(Q,{searchQuery:d})}),e.jsx(G,{opened:m,onClose:()=>n(!1),onSubmit:N,doctorData:i,setDoctorData:a,isLoading:s})]})]})}export{q as default};
