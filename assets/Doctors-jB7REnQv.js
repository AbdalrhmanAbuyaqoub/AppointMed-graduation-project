import{aL as T,o as D,j as e,q as g,s as k,r as o,G as p,aH as S,B as v,$ as x,ax as b,C as z,ar as I,p as f,t as L,T as A,H as O,aJ as B,aK as W,P as H,aM as G}from"./index-BMuruI52.js";import{u as M,D as P}from"./useWorkingHoursQueries-BXZhv3wQ.js";import{S as C,I as Q}from"./IconUserOff-C6rBggNB.js";import{T as r}from"./Table-CuW-9yNq.js";import{A as E}from"./Avatar-BK-tLZH8.js";import"./timezone-Ha5tP8ZT.js";function $({doctorId:d,workingDays:a}){return e.jsx(p,{gap:"8",children:P.map(t=>{const n=a.includes(t.value);return e.jsx(v,{bg:n?"violet":"gray.4",fw:500,p:4,h:24,w:24,style:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},title:t.day,children:e.jsx(o,{size:"xs",fw:500,c:"white",children:t.letter})},t.value)})})}function R({searchQuery:d=""}){const{doctors:a,isLoading:t}=T(),{doctorsWorkingDays:n,isLoading:m}=M(),u=D(),i=s=>{u(`/doctors/${s}`)},h=s=>{u(`/clinics/${s}`)},c=a.filter(s=>{const l=d.toLowerCase();return s.name.toLowerCase().includes(l)||s.clinicName.toLowerCase().includes(l)});return t||m?e.jsxs(g,{children:[e.jsx(C,{height:40,radius:"sm"}),[1,2,3].map(s=>e.jsx(C,{height:50,radius:"sm",mt:"sm"},s))]}):e.jsxs(r,{highlightOnHover:!0,verticalSpacing:"sm",horizontalSpacing:"lg",children:[e.jsx(r.Thead,{children:e.jsxs(r.Tr,{children:[e.jsx(r.Th,{c:"dimmed",children:"Name"}),e.jsx(r.Th,{c:"dimmed",children:"Working Days"}),e.jsx(r.Th,{c:"dimmed",children:"Clinic"})]})}),e.jsx(r.Tbody,{children:c.length===0?e.jsx(r.Tr,{children:e.jsx(r.Td,{colSpan:3,children:e.jsx(k,{py:"xl",children:e.jsxs(g,{align:"center",gap:"md",children:[e.jsx(Q,{size:30,opacity:.4}),e.jsx(o,{size:"sm",c:"dimmed",children:"No doctors found"})]})})})}):c.map(s=>e.jsxs(r.Tr,{style:{cursor:"pointer"},onClick:()=>i(s.id),children:[e.jsx(r.Td,{children:e.jsxs(p,{gap:"sm",children:[e.jsx(E,{style:{cursor:"pointer"},onClick:()=>i(s.id),size:"md",radius:"xl",variant:"filled",children:e.jsx(o,{fz:"sm",fw:600,c:"white",children:s.name.split(" ").map(l=>l[0]).join("").toUpperCase()})}),e.jsx(o,{size:"sm",fw:600,style:{cursor:"pointer"},onClick:()=>i(s.id),children:s.name})]})}),e.jsx(r.Td,{children:e.jsx($,{doctorId:s.id,workingDays:n[s.id]||[]})}),e.jsx(r.Td,{children:e.jsx(S,{variant:"light",size:"lg",radius:"sm",px:"md",style:{cursor:"pointer"},onClick:()=>h(s.clinicId),children:s.clinicName})})]},s.id))})]})}function _(){const[d,a]=x.useState(!1),[t,n]=x.useState(!1),[m,u]=x.useState(""),[i,h]=x.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),{clinics:c,addDoctor:s,isAddingDoctor:l}=b(),N=D(),y=()=>{!c||c.length===0?n(!0):a(!0)},w=async()=>{if(i.firstName.trim()&&i.lastName.trim()&&i.email.trim()&&i.phoneNumber.trim())try{await s({clinicId:parseInt(i.selectedClinic),firstName:i.firstName.trim(),lastName:i.lastName.trim(),email:i.email.trim(),address:i.address.trim(),phoneNumber:i.phoneNumber.trim()}),h({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),a(!1)}catch(j){console.error("Error adding doctor:",j)}};return e.jsxs(z,{pt:12,maw:1232,fluid:!0,children:[e.jsxs(I,{title:e.jsx(o,{fz:"lg",fw:700,children:"There is no Clinics"}),radius:"md",closeButtonProps:{radius:"xl"},centered:!0,opened:t,onClose:()=>n(!1),size:"md",children:[e.jsx(o,{fz:"sm",children:"You must create at least one clinic before adding a doctor."}),e.jsxs(p,{justify:"end",mt:"xl",children:[e.jsx(f,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),e.jsx(f,{bg:L.primaryColor,variant:"filled",onClick:()=>N("/clinics"),children:"Go to Clinics"})]})]}),e.jsxs(g,{children:[e.jsx(A,{fz:"24px",order:2,children:"Doctors"}),e.jsxs(p,{mt:40,justify:"space-between",children:[e.jsx(O,{size:"lg",placeholder:"Search doctors...",value:m,onChange:j=>u(j.target.value),leftSection:e.jsx(B,{size:16}),style:{flex:1,maxWidth:300},radius:"md"}),e.jsx(f,{size:"lg",variant:"outline",leftSection:e.jsx(W,{size:20}),onClick:y,radius:"xl",children:"Add New Doctor"})]}),e.jsx(H,{radius:"md",withBorder:!0,children:e.jsx(R,{searchQuery:m})}),e.jsx(G,{opened:d,onClose:()=>a(!1),onSubmit:w,doctorData:i,setDoctorData:h,isLoading:l})]})]})}export{_ as default};
