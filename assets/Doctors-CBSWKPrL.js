import{d as e,j as s,f as i,h as r,T as t,G as n,a3 as a,a4 as o,B as c,r as l,ao as d,C as m,an as h,e as u,t as j,P as x}from"./index-DbEKal5d.js";import{u as p}from"./useDoctorQueries-BWZbbdby.js";import{u as f,D as g}from"./useWorkingHoursQueries-u5MqkKwl.js";import{S as C,I as y}from"./IconUserOff-C1CzPpSU.js";import{T as N}from"./Table-CmdGb5B5.js";import{B as T}from"./Badge-BIiM0XzC.js";import{C as w}from"./CreateDoctorDrawer-D0aREZeE.js";import{u as D}from"./useClinicQueries-8PpHHGmv.js";import{T as v}from"./Title-CFcNY-rT.js";import{I as z}from"./IconPlus-CYMif05s.js";import"./useQuery-DzRLwVkj.js";import"./useMutation-CdDHAm4w.js";import"./appointmentService-DsFhdOZl.js";import"./NotificationService-DyTKbS-h.js";import"./Select-BwweLdW6.js";import"./CheckIcon-CgntXS1v.js";function k({doctorId:e,workingDays:i}){const r=0===i.length?[0,1,2,3,4,5,6]:i;return s.jsx(n,{gap:"8",children:g.map(e=>{const i=r.includes(e.value);return s.jsx(c,{bg:i?"violet":"gray.4",fw:500,p:4,h:24,w:24,style:{display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%"},title:e.day,children:s.jsx(t,{size:"xs",fw:500,c:"white",children:e.letter})},e.value)})})}function b({searchQuery:c=""}){const{doctors:l,isLoading:d}=p(),{doctorsWorkingDays:m,isLoading:h}=f(),u=e(),j=e=>{u(`/doctors/${e}`)},x=l.filter(e=>{const s=c.toLowerCase();return e.name.toLowerCase().includes(s)||e.clinicName.toLowerCase().includes(s)});return d||h?s.jsxs(i,{children:[s.jsx(C,{height:40,radius:"sm"}),[1,2,3].map(e=>s.jsx(C,{height:50,radius:"sm",mt:"sm"},e))]}):s.jsxs(N,{highlightOnHover:!0,verticalSpacing:"sm",horizontalSpacing:"lg",children:[s.jsx(N.Thead,{children:s.jsxs(N.Tr,{children:[s.jsx(N.Th,{c:"dimmed",children:"Name"}),s.jsx(N.Th,{c:"dimmed",children:"Working Days"}),s.jsx(N.Th,{c:"dimmed",children:"Clinic"})]})}),s.jsx(N.Tbody,{children:0===x.length?s.jsx(N.Tr,{children:s.jsx(N.Td,{colSpan:3,children:s.jsx(r,{py:"xl",children:s.jsxs(i,{align:"center",gap:"md",children:[s.jsx(y,{size:30,opacity:.4}),s.jsx(t,{size:"sm",c:"dimmed",children:"No doctors found"})]})})})}):x.map(e=>s.jsxs(N.Tr,{style:{cursor:"pointer"},onClick:()=>j(e.id),children:[s.jsx(N.Td,{children:s.jsxs(n,{gap:"sm",children:[s.jsx(a,{color:"#e7edf6",style:{cursor:"pointer"},onClick:()=>j(e.id),size:"md",radius:"xl",variant:"filled",children:s.jsx(t,{fz:"sm",children:o({fullName:e.name})})}),s.jsx(t,{size:"sm",fw:600,style:{cursor:"pointer"},onClick:()=>j(e.id),children:e.name})]})}),s.jsx(N.Td,{children:s.jsx(k,{doctorId:e.id,workingDays:m[e.id]||[]})}),s.jsx(N.Td,{children:s.jsx(T,{variant:"light",size:"lg",radius:"sm",px:"md",style:{cursor:"pointer"},onClick:()=>{return s=e.clinicId,void u(`/clinics/${s}`);var s},children:e.clinicName})})]},e.id))})]})}function S(){const[r,a]=l.useState(!1),[o,c]=l.useState(!1),{searchQuery:p}=d(),[f,g]=l.useState({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),{clinics:C,addDoctor:y,isAddingDoctor:N}=D(),T=e();return s.jsxs(m,{pt:12,maw:1232,fluid:!0,children:[s.jsxs(h,{title:s.jsx(t,{fz:"lg",fw:700,children:"There is no Clinics"}),radius:"md",closeButtonProps:{radius:"xl"},centered:!0,opened:o,onClose:()=>c(!1),size:"md",children:[s.jsx(t,{fz:"sm",children:"You must create at least one clinic before adding a doctor."}),s.jsxs(n,{justify:"end",mt:"xl",children:[s.jsx(u,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),s.jsx(u,{bg:j.primaryColor,variant:"filled",onClick:()=>T("/clinics"),children:"Go to Clinics"})]})]}),s.jsxs(i,{children:[s.jsx(v,{fz:"24px",order:2,children:"Doctors"}),s.jsx(n,{mt:40,justify:"flex-end",children:s.jsx(u,{size:"lg",variant:"outline",leftSection:s.jsx(z,{size:20}),onClick:()=>{C&&0!==C.length?a(!0):c(!0)},radius:"xl",children:"New Doctor"})}),s.jsx(x,{radius:"md",withBorder:!0,children:s.jsx(b,{searchQuery:p})}),s.jsx(w,{opened:r,onClose:()=>a(!1),onSubmit:async()=>{if(f.firstName.trim()&&f.lastName.trim()&&f.email.trim()&&f.phoneNumber.trim())try{await y({clinicId:parseInt(f.selectedClinic),firstName:f.firstName.trim(),lastName:f.lastName.trim(),email:f.email.trim(),address:f.address.trim(),phoneNumber:f.phoneNumber.trim()}),g({firstName:"",lastName:"",email:"",address:"",phoneNumber:"",selectedClinic:""}),a(!1)}catch(e){}},doctorData:f,setDoctorData:g,isLoading:N})]})]})}export{S as default};
